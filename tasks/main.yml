---
# Role tasks

- name: Setup fact to optimize further runs
  set_fact:
    vmware_provisioner_deps_resolved: yes
  tags:
    - role::vmware_provisioner

- include_tasks: patch.yml
  when: vmware_provisioner_patch_ansible_modules
  tags:
    - role::vmware_provisioner
    - role::vmware_provisioner::patch

- include_tasks: session.yml
  tags:
    - role::vmware_provisioner

- include_tasks: datacenters_fact.yml
  when: vmware_provisioner_datacenters_fact is not defined
  tags:
    - role::vmware_provisioner
    - role::vmware_provisioner::datacenters

- include_tasks: clusters_fact.yml
  when: vmware_provisioner_clusters_fact is not defined
  tags:
    - role::vmware_provisioner
    - role::vmware_provisioner::clusters

- include_tasks: datastores_fact.yml
  when: vmware_provisioner_datastores_fact is not defined
  tags:
    - role::vmware_provisioner
    - role::vmware_provisioner::datastores

- include_tasks: vms.yml
  tags:
    - role::vmware_provisioner
    - role::vmware_provisioner::vms

- include_tasks: vms_attrs.yml
  tags:
    - role::vmware_provisioner
    - role::vmware_provisioner::vms::attributes
